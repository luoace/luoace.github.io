<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"luoace.github.io","root":"/","scheme":"Mist","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="ä½ å¥½å‘€ ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿">
<meta property="og:type" content="article">
<meta property="og:title" content="helloworld1">
<meta property="og:url" content="https://luoace.github.io/2020/02/17/helloworld1/index.html">
<meta property="og:site_name" content="LCX">
<meta property="og:description" content="ä½ å¥½å‘€ ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://luoace.github.io/2020/02/17/helloworld1/img/heart.jpg">
<meta property="article:published_time" content="2020-02-17T04:08:25.000Z">
<meta property="article:modified_time" content="2020-02-17T12:30:35.625Z">
<meta property="article:author" content="æ–°ä¹‹è¨€">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luoace.github.io/2020/02/17/helloworld1/img/heart.jpg">

<link rel="canonical" href="https://luoace.github.io/2020/02/17/helloworld1/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>helloworld1 | LCX</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a href="https://github.com/luoace" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">LCX</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">æ–°ä¹‹è¨€</p>
  </div>

  <div class="site-nav-right"></div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home  //é¦–é¡µ"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user //å…³äº"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags  //æ ‡ç­¾"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th  //åˆ†ç±»"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive //å½’æ¡£"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-fw fa-calendar //æ—¶é—´è¡¨"></i>æ—¥ç¨‹è¡¨</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luoace.github.io/2020/02/17/helloworld1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang1.png">
      <meta itemprop="name" content="æ–°ä¹‹è¨€">
      <meta itemprop="description" content="æ±‚è€Œä¸å¾—ï¼Œå¾€å¾€ä¸æ±‚è€Œå¾—">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LCX">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          helloworld1
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-02-17 12:08:25 / ä¿®æ”¹æ—¶é—´ï¼š20:30:35" itemprop="dateCreated datePublished" datetime="2020-02-17T12:08:25+08:00">2020-02-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="ä½ å¥½å‘€"><a href="#ä½ å¥½å‘€" class="headerlink" title="ä½ å¥½å‘€"></a>ä½ å¥½å‘€</h2><hr>
<p>ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·ååˆ†å£«å¤§å¤«å£«å¤§å¤«æ˜¯é™ä½åˆ†æ•°çš„æœºæˆ¿å»ºè®¾çš„Â·<br>Moorez<br>é¦–é¡µ<br>åˆ†ç±»<br>å…³äº<br>å½’æ¡£<br>æ ‡ç­¾<br>æœç´¢<br>IVWEB ç©è½¬ WASM ç³»åˆ—-WEBGL YUVæ¸²æŸ“å›¾åƒå®è·µ<br>å‘è¡¨äº 2019-12-14   |   åˆ†ç±»äº å‰ç«¯   |   çƒ­åº¦40 â„ƒ<br>| å­—æ•°ç»Ÿè®¡ 5,369 å­— | é˜…è¯»æ—¶é•¿ 22 åˆ†é’Ÿ<br>æœ€è¿‘å›¢é˜Ÿåœ¨ç”¨ WASM + FFmpeg æ‰“é€ ä¸€ä¸ª WEB æ’­æ”¾å™¨ã€‚æˆ‘ä»¬æ˜¯é€šè¿‡å†™ C è¯­è¨€ç”¨ FFmpeg è§£ç è§†é¢‘ï¼Œé€šè¿‡ç¼–è¯‘ C è¯­è¨€è½¬ WASM è¿è¡Œåœ¨æµè§ˆå™¨ä¸Šä¸ JavaScript è¿›è¡Œé€šä¿¡ã€‚é»˜è®¤ FFmpeg å»è§£ç å‡ºæ¥çš„æ•°æ®æ˜¯ yuvï¼Œè€Œ canvas åªæ”¯æŒæ¸²æŸ“ rgbï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•å¤„ç†è¿™ä¸ªyuvï¼Œç¬¬ä¸€ä¸ªä½¿ç”¨ FFmpeg æš´éœ²çš„æ–¹æ³•å°† yuv ç›´æ¥è½¬æˆ rgb ç„¶åç»™ canvas è¿›è¡Œæ¸²æŸ“ï¼Œç¬¬äºŒä¸ªä½¿ç”¨ webgl å°† yuv è½¬ rgb ï¼Œåœ¨ canvas ä¸Šæ¸²æŸ“ã€‚ç¬¬ä¸€ä¸ªå¥½å¤„æ˜¯å†™æ³•å¾ˆç®€å•ï¼Œåªéœ€ FFmpeg æš´éœ²çš„æ–¹æ³•å°† yuv ç›´æ¥è½¬æˆ rgb ï¼Œç¼ºç‚¹å‘¢å°±æ˜¯ä¼šè€—è´¹ä¸€å®šçš„cpuï¼Œç¬¬äºŒä¸ªå¥½å¤„æ˜¯ä¼šåˆ©ç”¨ gpu è¿›è¡ŒåŠ é€Ÿï¼Œç¼ºç‚¹æ˜¯å†™æ³•æ¯”è¾ƒç¹çï¼Œè€Œä¸”éœ€è¦ç†Ÿæ‚‰ WEBGL ã€‚è€ƒè™‘åˆ°ä¸ºäº†å‡å°‘ cpu çš„å ç”¨ï¼Œåˆ©ç”¨ gpu è¿›è¡Œå¹¶è¡ŒåŠ é€Ÿï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ç¬¬äºŒç§æ–¹æ³•ã€‚</p>
<p>åœ¨è®² YUV ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ YUV æ˜¯æ€ä¹ˆè·å–åˆ°çš„ï¼š<br>å®ç°æ’­æ”¾å™¨å¿…å®šè¦ç»è¿‡çš„æ­¥éª¤<br>ç”±äºæˆ‘ä»¬æ˜¯å†™æ’­æ”¾å™¨ï¼Œå®ç°ä¸€ä¸ªæ’­æ”¾å™¨çš„æ­¥éª¤å¿…å®šä¼šç»è¿‡ä»¥ä¸‹è¿™å‡ ä¸ªæ­¥éª¤ï¼š</p>
<p>å°†è§†é¢‘çš„æ–‡ä»¶æ¯”å¦‚ mp4ï¼Œaviï¼Œflvç­‰ç­‰ï¼Œmp4ï¼Œaviï¼Œflv ç›¸å½“äºæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢åŒ…å«ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚å‹ç¼©çš„è§†é¢‘ï¼Œå‹ç¼©çš„éŸ³é¢‘ç­‰ç­‰ï¼Œ è¿›è¡Œè§£å¤ç”¨ï¼Œä»å®¹å™¨é‡Œé¢æå–å‡ºå‹ç¼©çš„è§†é¢‘ä»¥åŠéŸ³é¢‘ï¼Œå‹ç¼©çš„è§†é¢‘ä¸€èˆ¬æ˜¯ H265ã€H264 æ ¼å¼æˆ–è€…å…¶ä»–æ ¼å¼ï¼Œå‹ç¼©çš„éŸ³é¢‘ä¸€èˆ¬æ˜¯ aacæˆ–è€… mp3ã€‚<br>åˆ†åˆ«åœ¨å‹ç¼©çš„è§†é¢‘å’Œå‹ç¼©çš„éŸ³é¢‘è¿›è¡Œè§£ç ï¼Œå¾—åˆ°åŸå§‹çš„è§†é¢‘å’ŒéŸ³é¢‘ï¼ŒåŸå§‹çš„éŸ³é¢‘æ•°æ®ä¸€èˆ¬æ˜¯pcm ï¼Œè€ŒåŸå§‹çš„è§†é¢‘æ•°æ®ä¸€èˆ¬æ˜¯ yuv æˆ–è€… rgbã€‚<br>ç„¶åè¿›è¡ŒéŸ³è§†é¢‘çš„åŒæ­¥ã€‚<br>å¯ä»¥çœ‹åˆ°è§£ç å‹ç¼©çš„è§†é¢‘æ•°æ®ä¹‹åï¼Œä¸€èˆ¬å°±ä¼šå¾—åˆ° yuvã€‚<br>YUV<br>YUV æ˜¯ä»€ä¹ˆ<br>å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´ï¼ŒYUV å…¶å®æœ‰ç‚¹é™Œç”Ÿï¼Œå¯¹äºæè¿‡éŸ³è§†é¢‘å¼€å‘çš„ä¸€èˆ¬ä¼šæ¥è§¦åˆ°è¿™ä¸ªï¼Œç®€å•æ¥è¯´ï¼ŒYUV å’Œæˆ‘ä»¬ç†Ÿæ‚‰çš„ RGB å·®ä¸å¤šï¼Œéƒ½æ˜¯é¢œè‰²ç¼–ç æ–¹å¼ï¼Œåªä¸è¿‡å®ƒä»¬çš„ä¸‰ä¸ªå­—æ¯ä»£è¡¨çš„æ„ä¹‰ä¸ RGB ä¸åŒï¼ŒYUV çš„ â€œYâ€ è¡¨ç¤ºæ˜äº®åº¦ï¼ˆLuminanceæˆ–Lumaï¼‰ï¼Œä¹Ÿå°±æ˜¯ç°åº¦å€¼ï¼›è€Œ â€Uâ€ å’Œ â€Vâ€ è¡¨ç¤ºçš„åˆ™æ˜¯è‰²åº¦ï¼ˆChrominanceæˆ–Chromaï¼‰ï¼Œæè¿°å½±åƒè‰²å½©åŠé¥±å’Œåº¦ï¼Œç”¨äºæŒ‡å®šåƒç´ çš„é¢œè‰²ã€‚</p>
<p>ä¸ºäº†è®©å¤§å®¶å¯¹ YUV æœ‰æ›´åŠ ç›´è§‚çš„æ„Ÿå—ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ï¼ŒYï¼ŒUï¼ŒV å•ç‹¬æ˜¾ç¤ºåˆ†åˆ«æ˜¯ä»€ä¹ˆæ ·å­ï¼Œè¿™é‡Œä½¿ç”¨äº† FFmpeg å‘½ä»¤å°†ä¸€å¼ ç«å½±å¿è€…çš„å®‡æ™ºæ³¢é¼¬å›¾ç‰‡è½¬æˆYUV420Pï¼š</p>
<p>ffmpeg -i frame.jpg -s 352x288 -pix_fmt yuv420p test.yuv<br>åœ¨ GLYUVPlayè½¯ä»¶ä¸Šæ‰“å¼€ test.yuvï¼Œæ˜¾ç¤ºåŸå›¾ï¼š<br>åŸå›¾<br>Yåˆ†é‡å•ç‹¬æ˜¾ç¤ºï¼š<br>Y<br>Uåˆ†é‡å•ç‹¬æ˜¾ç¤ºï¼š<br>U<br>V åˆ†é‡å•ç‹¬æ˜¾ç¤ºï¼š<br>V<br>ç”±ä¸Šé¢å¯ä»¥å‘ç°ï¼ŒY å•ç‹¬æ˜¾ç¤ºçš„æ—¶å€™æ˜¯å¯ä»¥æ˜¾ç¤ºå®Œæ•´çš„å›¾åƒçš„ï¼Œåªä¸è¿‡å›¾ç‰‡æ˜¯ç°è‰²çš„ã€‚è€ŒUï¼ŒVåˆ™ä»£è¡¨çš„æ˜¯è‰²åº¦ï¼Œä¸€ä¸ªåè“ï¼Œä¸€ä¸ªåçº¢ã€‚</p>
<p>ä½¿ç”¨YUV çš„å¥½å¤„<br>ç”±åˆšæ‰çœ‹åˆ°çš„é‚£æ ·ï¼ŒY å•ç‹¬æ˜¾ç¤ºæ˜¯é»‘ç™½å›¾åƒï¼Œå› æ­¤YUVæ ¼å¼ç”±å½©è‰²è½¬é»‘ç™½å¾ˆç®€å•ï¼Œå¯ä»¥å…¼å®¹è€å¼é»‘ç™½ç”µè§†ï¼Œè¿™ä¸€ç‰¹æ€§ç”¨åœ¨äºç”µè§†ä¿¡å·ä¸Šã€‚<br>YUVçš„æ•°æ®å°ºå¯¸ä¸€èˆ¬éƒ½æ¯”RGBæ ¼å¼å°ï¼Œå¯ä»¥èŠ‚çº¦ä¼ è¾“çš„å¸¦å®½ã€‚ï¼ˆä½†å¦‚æœç”¨YUV444çš„è¯ï¼Œå’ŒRGB24ä¸€æ ·éƒ½æ˜¯24ä½ï¼‰<br>YUV é‡‡æ ·<br>å¸¸è§çš„YUVçš„é‡‡æ ·æœ‰YUV444ï¼ŒYUV422ï¼ŒYUV420ï¼š</p>
<p>æ³¨ï¼šé»‘ç‚¹è¡¨ç¤ºé‡‡æ ·è¯¥åƒç´ ç‚¹çš„Yåˆ†é‡ï¼Œç©ºå¿ƒåœ†åœˆè¡¨ç¤ºé‡‡ç”¨è¯¥åƒç´ ç‚¹çš„UVåˆ†é‡ã€‚</p>
<p>YUV 4:4:4é‡‡æ ·ï¼Œæ¯ä¸€ä¸ªYå¯¹åº”ä¸€ç»„UVåˆ†é‡ã€‚<br>YUV 4:2:2é‡‡æ ·ï¼Œæ¯ä¸¤ä¸ªYå…±ç”¨ä¸€ç»„UVåˆ†é‡ã€‚<br>YUV 4:2:0é‡‡æ ·ï¼Œæ¯å››ä¸ªYå…±ç”¨ä¸€ç»„UVåˆ†é‡ã€‚<br>YUV å­˜å‚¨æ–¹å¼<br>YUVçš„å­˜å‚¨æ ¼å¼æœ‰ä¸¤ç±»ï¼špackedï¼ˆæ‰“åŒ…ï¼‰å’Œ planarï¼ˆå¹³é¢ï¼‰ï¼š</p>
<p>packed çš„YUVæ ¼å¼ï¼Œæ¯ä¸ªåƒç´ ç‚¹çš„Y,U,Væ˜¯è¿ç»­äº¤é”™å­˜å‚¨çš„ã€‚<br>planar çš„YUVæ ¼å¼ï¼Œå…ˆè¿ç»­å­˜å‚¨æ‰€æœ‰åƒç´ ç‚¹çš„Yï¼Œç´§æ¥ç€å­˜å‚¨æ‰€æœ‰åƒç´ ç‚¹çš„Uï¼Œéšåæ˜¯æ‰€æœ‰åƒç´ ç‚¹çš„Vã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äº planar æ¨¡å¼ï¼ŒYUV å¯ä»¥è¿™ä¹ˆå­˜ YYYYUUVVï¼Œå¯¹äº packed æ¨¡å¼ï¼ŒYUV å¯ä»¥è¿™ä¹ˆå­˜YUYVYUYVã€‚</p>
<p>YUV æ ¼å¼ä¸€èˆ¬æœ‰å¤šç§ï¼ŒYUV420SPã€YUV420Pã€YUV422Pï¼ŒYUV422SPç­‰ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹æ¯”è¾ƒå¸¸è§çš„æ ¼å¼ï¼š</p>
<p>YUV420Pï¼ˆæ¯å››ä¸ª Y ä¼šå…±ç”¨ä¸€ç»„ UV åˆ†é‡ï¼‰ï¼š</p>
<p>YUV420SPï¼ˆpackedï¼Œæ¯å››ä¸ª Y ä¼šå…±ç”¨ä¸€ç»„ UV åˆ†é‡ï¼Œå’ŒYUV420Pä¸åŒçš„æ˜¯ï¼ŒYUV420SPå­˜å‚¨çš„æ—¶å€™ Uï¼ŒV æ˜¯äº¤é”™å­˜å‚¨ï¼‰ï¼š</p>
<p>YUV422Pï¼ˆplanarï¼Œæ¯ä¸¤ä¸ª Y å…±ç”¨ä¸€ç»„ UV åˆ†é‡ï¼Œæ‰€ä»¥ Uå’Œ V ä¼šæ¯” YUV420P U å’Œ V å„å¤šåŠ ä¸€è¡Œï¼‰ï¼š</p>
<p>YUV422SPï¼ˆpackedï¼Œæ¯ä¸¤ä¸ª Y å…±ç”¨ä¸€ç»„ UV åˆ†é‡ï¼‰ï¼š</p>
<p>å…¶ä¸­YUV420På’ŒYUV420SPæ ¹æ®Uã€Vçš„é¡ºåºï¼Œåˆå¯åˆ†å‡º2ç§æ ¼å¼ï¼š</p>
<p>YUV420Pï¼šUå‰Våå³YUV420Pï¼Œä¹Ÿå«I420ï¼ŒVå‰Uåï¼Œå«YV12ã€‚</p>
<p>YUV420SPï¼šUå‰Våå«NV12ï¼ŒVå‰Uåå«NV21ã€‚</p>
<p>æ•°æ®æ’åˆ—å¦‚ä¸‹:</p>
<p>I420: YYYYYYYY UU VV =&gt;YUV420P<br>YV12: YYYYYYYY VV UU =&gt;YUV420P<br>NV12: YYYYYYYY UV UV =&gt;YUV420SP<br>NV21: YYYYYYYY VU VU =&gt;YUV420SP<br>è‡³äºä¸ºå•¥ä¼šæœ‰è¿™ä¹ˆå¤šæ ¼å¼ï¼Œç»è¿‡å¤§é‡æœç´¢å‘ç°åŸå› æ˜¯ä¸ºäº†é€‚é…ä¸åŒçš„ç”µè§†å¹¿æ’­åˆ¶å¼å’Œè®¾å¤‡ç³»ç»Ÿï¼Œæ¯”å¦‚ ios ä¸‹åªæœ‰è¿™ä¸€ç§æ¨¡å¼NV12ï¼Œå®‰å“çš„æ¨¡å¼æ˜¯ NV21ï¼Œæ¯”å¦‚ YUV411ã€YUV420æ ¼å¼å¤šè§äºæ•°ç æ‘„åƒæœºæ•°æ®ä¸­ï¼Œå‰è€…ç”¨äºNTSCåˆ¶ï¼Œåè€…ç”¨äº PALåˆ¶ã€‚è‡³äºç”µè§†å¹¿æ’­åˆ¶å¼çš„ä»‹ç»æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡ç« ã€æ ‡å‡†ã€‘NTSCã€PALã€SECAMä¸‰å¤§åˆ¶å¼ç®€ä»‹</p>
<p>YUV è®¡ç®—æ–¹æ³•<br>ä»¥YUV420På­˜å‚¨ä¸€å¼ 1080 x 1280å›¾ç‰‡ä¸ºä¾‹å­ï¼Œå…¶å­˜å‚¨å¤§å°ä¸º ((1080 x 1280 x 3) &gt;&gt; 1) ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ªæ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸‹é¢è¿™å¼ å›¾ï¼š</p>
<p>ä»¥ Y420P å­˜å‚¨é‚£ä¹ˆ Y å çš„å¤§å°ä¸º W x H = 1080x1280ï¼ŒU ä¸º(W/2) * (H/2)= (W<em>H)/4 = (1080x1280)/4ï¼ŒåŒç† Vä¸º<br>(W</em>H)/4 = (1080x1280)/4ï¼Œå› æ­¤ä¸€å¼ å›¾ä¸º Y+U+V = (1080x1280)*3/2ã€‚<br>ç”±äºä¸‰ä¸ªéƒ¨åˆ†å†…éƒ¨å‡æ˜¯è¡Œä¼˜å…ˆå­˜å‚¨ï¼Œä¸‰ä¸ªéƒ¨åˆ†ä¹‹é—´æ˜¯Y,U,V é¡ºåºå­˜å‚¨ï¼Œé‚£ä¹ˆYUVçš„å­˜å‚¨ä½ç½®å¦‚ä¸‹ï¼ˆPSï¼šåé¢ä¼šç”¨åˆ°ï¼‰ï¼š</p>
<p>Yï¼š0 åˆ° 1080<em>1280<br>Uï¼š1080</em>1280 åˆ° (1080<em>1280)</em>5/4<br>Vï¼š(1080<em>1280)</em>5/4 åˆ° (1080<em>1280)</em>3/2<br>WEBGL<br>WEBGL æ˜¯ä»€ä¹ˆ<br>ç®€å•æ¥è¯´ï¼ŒWebGLæ˜¯ä¸€é¡¹ç”¨æ¥åœ¨ç½‘é¡µä¸Šç»˜åˆ¶å’Œæ¸²æŸ“å¤æ‚3Då›¾å½¢ï¼Œå¹¶å…è®¸ç”¨æˆ·ä¸ä¹‹äº¤äº’çš„æŠ€æœ¯ã€‚</p>
<p>WEBGL ç»„æˆ<br>åœ¨ webgl ä¸–ç•Œä¸­ï¼Œèƒ½ç»˜åˆ¶çš„åŸºæœ¬å›¾å½¢å…ƒç´ åªæœ‰ç‚¹ã€çº¿ã€ä¸‰è§’å½¢ï¼Œæ¯ä¸ªå›¾åƒéƒ½æ˜¯ç”±å¤§å¤§å°å°çš„ä¸‰è§’å½¢ç»„æˆï¼Œå¦‚ä¸‹å›¾ï¼Œæ— è®ºæ˜¯å¤šä¹ˆå¤æ‚çš„å›¾å½¢ï¼Œå…¶åŸºæœ¬ç»„æˆéƒ¨åˆ†éƒ½æ˜¯ç”±ä¸‰è§’å½¢ç»„æˆã€‚</p>
<p>å›¾æ¥æºäºç½‘ç»œ</p>
<p>ç€è‰²å™¨<br>ç€è‰²å™¨æ˜¯åœ¨GPUä¸Šè¿è¡Œçš„ç¨‹åºï¼Œæ˜¯ç”¨OpenGL ESç€è‰²è¯­è¨€ç¼–å†™çš„ï¼Œæœ‰ç‚¹ç±»ä¼¼ c è¯­è¨€ï¼š</p>
<p>å…·ä½“çš„è¯­æ³•å¯ä»¥å‚è€ƒç€è‰²å™¨è¯­è¨€ GLSL (opengl-shader-language)å…¥é—¨å¤§å…¨ï¼Œè¿™é‡Œä¸åœ¨å¤šåŠ èµ˜è¿°ã€‚</p>
<p>åœ¨ WEBGL ä¸­æƒ³è¦ç»˜åˆ¶å›¾å½¢å°±å¿…é¡»è¦æœ‰ä¸¤ä¸ªç€è‰²å™¨ï¼š</p>
<p>é¡¶ç‚¹ç€è‰²å™¨<br>ç‰‡å…ƒç€è‰²å™¨<br>å…¶ä¸­é¡¶ç‚¹ç€è‰²å™¨çš„ä¸»è¦åŠŸèƒ½å°±æ˜¯ç”¨æ¥å¤„ç†é¡¶ç‚¹çš„ï¼Œè€Œç‰‡å…ƒç€è‰²å™¨åˆ™æ˜¯ç”¨æ¥å¤„ç†ç”±å…‰æ …åŒ–é˜¶æ®µç”Ÿæˆçš„æ¯ä¸ªç‰‡å…ƒï¼ˆPSï¼šç‰‡å…ƒå¯ä»¥ç†è§£ä¸ºåƒç´ ï¼‰ï¼Œæœ€åè®¡ç®—å‡ºæ¯ä¸ªåƒç´ çš„é¢œè‰²ã€‚</p>
<p>WEBGL ç»˜åˆ¶æµç¨‹<br>ä¸€ã€æä¾›é¡¶ç‚¹åæ ‡<br>å› ä¸ºç¨‹åºå¾ˆå‚»ï¼Œä¸çŸ¥é“å›¾å½¢çš„å„ä¸ªé¡¶ç‚¹ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å»æä¾›ï¼Œé¡¶ç‚¹åæ ‡å¯ä»¥æ˜¯è‡ªå·±æ‰‹åŠ¨å†™æˆ–è€…æ˜¯ç”±è½¯ä»¶å¯¼å‡ºï¼š</p>
<p>åœ¨è¿™ä¸ªå›¾ä¸­ï¼Œæˆ‘ä»¬æŠŠé¡¶ç‚¹å†™å…¥åˆ°ç¼“å†²åŒºé‡Œï¼Œç¼“å†²åŒºå¯¹è±¡æ˜¯WebGLç³»ç»Ÿä¸­çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ€§åœ°å‘ç¼“å†²åŒºå¯¹è±¡ä¸­å¡«å……å¤§é‡çš„é¡¶ç‚¹æ•°æ®ï¼Œç„¶åå°†è¿™äº›æ•°æ®ä¿å­˜åœ¨å…¶ä¸­ï¼Œä¾›é¡¶ç‚¹ç€è‰²å™¨ä½¿ç”¨ã€‚æ¥ç€æˆ‘ä»¬åˆ›å»ºå¹¶ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨ï¼Œå¹¶ç”¨ program è¿æ¥ä¸¤ä¸ªç€è‰²å™¨ï¼Œå¹¶ä½¿ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ç®€å•ç†è§£ä¸‹ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£æˆåˆ›å»ºFragment å…ƒç´ ï¼š let f = document.createDocumentFragment()ï¼Œ<br>æ‰€æœ‰çš„ç€è‰²å™¨åˆ›å»ºå¹¶ç¼–è¯‘åä¼šå¤„åœ¨ä¸€ç§æ¸¸ç¦»çš„çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦å°†ä»–ä»¬è”ç³»èµ·æ¥ï¼Œå¹¶ä½¿ç”¨ï¼ˆå¯ä»¥ç†è§£æˆ document.body.appendChild(f)ï¼Œæ·»åŠ åˆ° bodyï¼Œdom å…ƒç´ æ‰èƒ½è¢«çœ‹åˆ°ï¼Œä¹Ÿå°±æ˜¯è”ç³»å¹¶ä½¿ç”¨ï¼‰ã€‚<br>æ¥ç€æˆ‘ä»¬è¿˜éœ€è¦å°†ç¼“å†²åŒºä¸é¡¶ç‚¹ç€è‰²å™¨è¿›è¡Œè¿æ¥ï¼Œè¿™æ ·æ‰èƒ½ç”Ÿæ•ˆã€‚</p>
<p>äºŒã€å›¾å…ƒè£…é…<br>æˆ‘ä»¬æä¾›é¡¶ç‚¹ä¹‹åï¼ŒGPUæ ¹æ®æˆ‘ä»¬æä¾›çš„é¡¶ç‚¹æ•°é‡ï¼Œä¼šæŒ¨ä¸ªæ‰§è¡Œé¡¶ç‚¹ç€è‰²å™¨ç¨‹åºï¼Œç”Ÿæˆé¡¶ç‚¹æœ€ç»ˆçš„åæ ‡ï¼Œå°†å›¾å½¢è£…é…èµ·æ¥ã€‚å¯ä»¥ç†è§£æˆåˆ¶ä½œé£ç­ï¼Œå°±éœ€è¦å°†é£ç­éª¨æ¶å…ˆæ­å»ºèµ·æ¥ï¼Œå›¾å…ƒè£…é…å°±æ˜¯åœ¨è¿™ä¸€é˜¶æ®µã€‚</p>
<p>ä¸‰ã€å…‰æ …åŒ–<br>è¿™ä¸€é˜¶æ®µå°±å¥½æ¯”æ˜¯åˆ¶ä½œé£ç­ï¼Œæ­å»ºå¥½é£ç­éª¨æ¶åï¼Œä½†æ˜¯æ­¤æ—¶å´ä¸èƒ½é£èµ·æ¥ï¼Œå› ä¸ºé‡Œé¢éƒ½æ˜¯ç©ºçš„ï¼Œéœ€è¦ä¸ºéª¨æ¶æ·»åŠ å¸ƒæ–™ã€‚è€Œå…‰æ …åŒ–å°±æ˜¯åœ¨è¿™ä¸€é˜¶æ®µï¼Œå°†å›¾å…ƒè£…é…å¥½çš„å‡ ä½•å›¾å½¢è½¬æˆç‰‡å…ƒï¼ˆPS: ç‰‡å…ƒå¯ä»¥ç†è§£æˆåƒç´ ï¼‰ã€‚</p>
<p>å››ã€ç€è‰²ä¸æ¸²æŸ“</p>
<p>ç€è‰²è¿™ä¸€é˜¶æ®µå°±å¥½æ¯”é£ç­å¸ƒæ–™æ­å»ºå®Œæˆï¼Œä½†æ˜¯æ­¤æ—¶å¹¶æ²¡æœ‰ä»€ä¹ˆå›¾æ¡ˆï¼Œéœ€è¦ç»˜åˆ¶å›¾æ¡ˆï¼Œè®©é£ç­æ›´åŠ å¥½çœ‹ï¼Œä¹Ÿå°±æ˜¯å…‰æ …åŒ–åçš„å›¾å½¢æ­¤æ—¶å¹¶æ²¡æœ‰é¢œè‰²ï¼Œéœ€è¦ç»è¿‡ç‰‡å…ƒç€è‰²å™¨å¤„ç†ï¼Œé€ç‰‡å…ƒè¿›è¡Œä¸Šè‰²å¹¶å†™åˆ°é¢œè‰²ç¼“å†²åŒºé‡Œï¼Œæœ€ååœ¨æµè§ˆå™¨æ‰èƒ½æ˜¾ç¤ºæœ‰å›¾åƒçš„å‡ ä½•å›¾å½¢ã€‚</p>
<p>æ€»ç»“<br>WEBGL ç»˜åˆ¶æµç¨‹å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<p>æä¾›é¡¶ç‚¹åæ ‡ï¼ˆéœ€è¦æˆ‘ä»¬æä¾›ï¼‰<br>å›¾å…ƒè£…é…ï¼ˆæŒ‰å›¾å…ƒç±»å‹ç»„è£…æˆå›¾å½¢ï¼‰<br>å…‰æ …åŒ–ï¼ˆå°†å›¾å…ƒè£…é…å¥½çš„å›¾å½¢ï¼Œç”Ÿæˆåƒç´ ç‚¹ï¼‰<br>æä¾›é¢œè‰²å€¼ï¼ˆå¯ä»¥åŠ¨æ€è®¡ç®—ï¼Œåƒç´ ç€è‰²ï¼‰<br>é€šè¿‡ canvas ç»˜åˆ¶åœ¨æµè§ˆå™¨ä¸Šã€‚</p>
<p>WEBGL YUV ç»˜åˆ¶å›¾åƒæ€è·¯<br>ç”±äºæ¯ä¸ªè§†é¢‘å¸§çš„å›¾åƒéƒ½ä¸å¤ªä¸€æ ·ï¼Œæˆ‘ä»¬è‚¯å®šä¸å¯èƒ½çŸ¥é“é‚£ä¹ˆå¤šé¡¶ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå°†è§†é¢‘å¸§çš„å›¾åƒç”¨ webgl ç”»å‡ºæ¥å‘¢ï¼Ÿè¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªæŠ€å·§â€”çº¹ç†æ˜ å°„ã€‚ç®€å•æ¥è¯´å°±æ˜¯å°†ä¸€å¼ å›¾åƒè´´åœ¨ä¸€ä¸ªå‡ ä½•å›¾å½¢è¡¨é¢ï¼Œä½¿å‡ ä½•å›¾å½¢çœ‹èµ·æ¥åƒæ˜¯æœ‰å›¾åƒçš„å‡ ä½•å›¾å½¢ï¼Œä¹Ÿå°±æ˜¯å°†çº¹ç†åæ ‡å’Œ webgl ç³»ç»Ÿåæ ‡è¿›è¡Œä¸€ä¸€å¯¹åº”ï¼š</p>
<p>å¦‚ä¸Šå›¾ï¼Œä¸Šé¢é‚£ä¸ªæ˜¯çº¹ç†åæ ‡ï¼Œåˆ†ä¸º s å’Œ t åæ ‡ï¼ˆæˆ–è€…å« uv åæ ‡ï¼‰ï¼Œå€¼çš„èŒƒå›´åœ¨ã€0ï¼Œ1ã€‘ä¹‹é—´ï¼Œå€¼å’Œå›¾åƒå¤§å°ã€åˆ†è¾¨ç‡æ— å…³ã€‚ä¸‹é¢é‚£å¼ å›¾æ˜¯webglåæ ‡ç³»ç»Ÿï¼Œæ˜¯ä¸€ä¸ªä¸‰ç»´çš„åæ ‡ç³»ç»Ÿï¼Œè¿™é‡Œå£°æ˜äº†å››ä¸ªé¡¶ç‚¹ï¼Œç”¨ä¸¤ä¸ªä¸‰è§’å½¢ç»„è£…æˆä¸€ä¸ªé•¿æ–¹å½¢ï¼Œç„¶åå°†çº¹ç†åæ ‡çš„é¡¶ç‚¹ä¸ webgl åæ ‡ç³»è¿›è¡Œä¸€ä¸€å¯¹åº”ï¼Œæœ€ç»ˆä¼ ç»™ç‰‡å…ƒç€è‰²å™¨ï¼Œç‰‡å…ƒç€è‰²å™¨æå–å›¾ç‰‡çš„ä¸€ä¸ªä¸ªçº¹ç´ é¢œè‰²ï¼Œè¾“å‡ºåœ¨é¢œè‰²ç¼“å†²åŒºé‡Œï¼Œæœ€ç»ˆç»˜åˆ¶åœ¨æµè§ˆå™¨é‡Œï¼ˆPSï¼šçº¹ç´ ä½ å¯ä»¥ç†è§£ä¸ºç»„æˆçº¹ç†å›¾åƒçš„åƒç´ ï¼‰ã€‚ä½†æ˜¯å¦‚æœæŒ‰å›¾ä¸Šè¿›è¡Œä¸€ä¸€å¯¹åº”çš„è¯ï¼Œæˆåƒä¼šæ˜¯åçš„ï¼Œå› ä¸º canvas çš„å›¾åƒåæ ‡ï¼Œé»˜è®¤ï¼ˆ0ï¼Œ0ï¼‰æ˜¯åœ¨å·¦ä¸Šè§’ï¼š</p>
<p>è€Œçº¹ç†åæ ‡åˆ™æ˜¯åœ¨å·¦ä¸‹è§’ï¼Œæ‰€ä»¥ç»˜åˆ¶æ—¶æˆåƒå°±ä¼šå€’ç«‹ï¼Œè§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p>
<p>å¯¹çº¹ç†å›¾åƒè¿›è¡Œ Y è½´ç¿»è½¬ï¼Œwebgl æä¾›äº†apiï¼š</p>
<p>// 1ä»£è¡¨å¯¹çº¹ç†å›¾åƒè¿›è¡Œyè½´åè½¬<br>gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);<br>çº¹ç†åæ ‡å’Œ webgl åæ ‡æ˜ å°„è¿›è¡Œå€’è½¬ï¼Œä¸¾ä¸ªæ —å­ğŸŒ°ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæœ¬æ¥çš„çº¹ç†åæ ‡ï¼ˆ0.0ï¼Œ1.0ï¼‰å¯¹åº”çš„æ˜¯webgl åæ ‡ï¼ˆ-1.0ï¼Œ1.0ï¼Œ0.0ï¼‰ï¼Œï¼ˆ0.0ï¼Œ0.0ï¼‰å¯¹åº”çš„æ˜¯ï¼ˆ-1.0ï¼Œ-1.0ï¼Œ0.0ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å€’è½¬è¿‡æ¥ï¼Œï¼ˆ0.0ï¼Œ1.0ï¼‰å¯¹åº”çš„æ˜¯ï¼ˆ-1.0ï¼Œ-1.0ï¼Œ0.0ï¼‰ï¼Œè€Œï¼ˆ0.0ï¼Œ0.0ï¼‰å¯¹åº”çš„æ˜¯ï¼ˆ-1.0ï¼Œ1.0ï¼Œ0.0ï¼‰ï¼Œè¿™æ ·åœ¨æµè§ˆå™¨æˆåƒå°±ä¸ä¼šæ˜¯åçš„ã€‚</p>
<p>è¯¦ç»†æ­¥éª¤</p>
<p>ç€è‰²å™¨éƒ¨åˆ†</p>
<p>// é¡¶ç‚¹ç€è‰²å™¨vertexShader<br>attribute lowp vec4 a_vertexPosition; // é€šè¿‡ js ä¼ é€’é¡¶ç‚¹åæ ‡<br>attribute vec2 a_texturePosition; // é€šè¿‡ js ä¼ é€’çº¹ç†åæ ‡<br>varying vec2 v_texCoord; // ä¼ é€’çº¹ç†åæ ‡ç»™ç‰‡å…ƒç€è‰²å™¨<br>void main(){<br>    gl_Position=a_vertexPosition;// è®¾ç½®é¡¶ç‚¹åæ ‡<br>    v_texCoord=a_texturePosition;// è®¾ç½®çº¹ç†åæ ‡<br>}<br>// ç‰‡å…ƒç€è‰²å™¨fragmentShader<br>precision lowp float;// lowpä»£è¡¨è®¡ç®—ç²¾åº¦ï¼Œè€ƒè™‘èŠ‚çº¦æ€§èƒ½ä½¿ç”¨äº†æœ€ä½ç²¾åº¦<br>uniform sampler2D samplerY;// sampler2Dæ˜¯å–æ ·å™¨ç±»å‹ï¼Œå›¾ç‰‡çº¹ç†æœ€ç»ˆå­˜å‚¨åœ¨è¯¥ç±»å‹å¯¹è±¡ä¸­<br>uniform sampler2D samplerU;// sampler2Dæ˜¯å–æ ·å™¨ç±»å‹ï¼Œå›¾ç‰‡çº¹ç†æœ€ç»ˆå­˜å‚¨åœ¨è¯¥ç±»å‹å¯¹è±¡ä¸­<br>uniform sampler2D samplerV;// sampler2Dæ˜¯å–æ ·å™¨ç±»å‹ï¼Œå›¾ç‰‡çº¹ç†æœ€ç»ˆå­˜å‚¨åœ¨è¯¥ç±»å‹å¯¹è±¡ä¸­<br>varying vec2 v_texCoord; // æ¥å—é¡¶ç‚¹ç€è‰²å™¨ä¼ æ¥çš„çº¹ç†åæ ‡<br>void main(){<br>  float r,g,b,y,u,v,fYmul;<br>  y = texture2D(samplerY, v_texCoord).r;<br>  u = texture2D(samplerU, v_texCoord).r;<br>  v = texture2D(samplerV, v_texCoord).r;</p>
<pre><code>// YUV420P è½¬ RGB    </code></pre><p>  fYmul = y * 1.1643828125;<br>  r = fYmul + 1.59602734375 * v - 0.870787598;<br>  g = fYmul - 0.39176171875 * u - 0.81296875 * v + 0.52959375;<br>  b = fYmul + 2.01723046875 * u - 1.081389160375;<br>  gl_FragColor = vec4(r, g, b, 1.0);<br>}<br>åˆ›å»ºå¹¶ç¼–è¯‘ç€è‰²å™¨ï¼Œå°†é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨è¿æ¥åˆ° programï¼Œå¹¶ä½¿ç”¨ï¼š</p>
<p>let vertexShader=this._compileShader(vertexShaderSource,gl.VERTEX_SHADER);// åˆ›å»ºå¹¶ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨<br>let fragmentShader=this._compileShader(fragmentShaderSource,gl.FRAGMENT_SHADER);// åˆ›å»ºå¹¶ç¼–è¯‘ç‰‡å…ƒç€è‰²å™¨<br>let program=this._createProgram(vertexShader,fragmentShader);// åˆ›å»ºprogramå¹¶è¿æ¥ç€è‰²å™¨<br>åˆ›å»ºç¼“å†²åŒºï¼Œå­˜é¡¶ç‚¹å’Œçº¹ç†åæ ‡ï¼ˆPSï¼šç¼“å†²åŒºå¯¹è±¡æ˜¯WebGLç³»ç»Ÿä¸­çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ€§åœ°å‘ç¼“å†²åŒºå¯¹è±¡ä¸­å¡«å……å¤§é‡çš„é¡¶ç‚¹æ•°æ®ï¼Œç„¶åå°†è¿™äº›æ•°æ®ä¿å­˜åœ¨å…¶ä¸­ï¼Œä¾›é¡¶ç‚¹ç€è‰²å™¨ä½¿ç”¨ï¼‰ã€‚</p>
<p>let vertexBuffer = gl.createBuffer();<br>let vertexRectangle = new Float32Array([<br>    1.0,<br>    1.0,<br>    0.0,<br>    -1.0,<br>    1.0,<br>    0.0,<br>    1.0,<br>    -1.0,<br>    0.0,<br>    -1.0,<br>    -1.0,<br>    0.0<br>]);<br>gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);<br>// å‘ç¼“å†²åŒºå†™å…¥æ•°æ®<br>gl.bufferData(gl.ARRAY_BUFFER, vertexRectangle, gl.STATIC_DRAW);<br>// æ‰¾åˆ°é¡¶ç‚¹çš„ä½ç½®<br>let vertexPositionAttribute = gl.getAttribLocation(program, â€˜a_vertexPositionâ€™);<br>// å‘Šè¯‰æ˜¾å¡ä»å½“å‰ç»‘å®šçš„ç¼“å†²åŒºä¸­è¯»å–é¡¶ç‚¹æ•°æ®<br>gl.vertexAttribPointer(vertexPositionAttribute, 3, gl.FLOAT, false, 0, 0);<br>// è¿æ¥vertexPosition å˜é‡ä¸åˆ†é…ç»™å®ƒçš„ç¼“å†²åŒºå¯¹è±¡<br>gl.enableVertexAttribArray(vertexPositionAttribute);<br>// å£°æ˜çº¹ç†åæ ‡<br>let textureRectangle = new Float32Array([1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0]);<br>let textureBuffer = gl.createBuffer();<br>gl.bindBuffer(gl.ARRAY_BUFFER, textureBuffer);<br>gl.bufferData(gl.ARRAY_BUFFER, textureRectangle, gl.STATIC_DRAW);<br>let textureCoord = gl.getAttribLocation(program, â€˜a_texturePositionâ€™);<br>gl.vertexAttribPointer(textureCoord, 2, gl.FLOAT, false, 0, 0);<br>gl.enableVertexAttribArray(textureCoord);<br>åˆå§‹åŒ–å¹¶æ¿€æ´»çº¹ç†å•å…ƒï¼ˆYUVï¼‰</p>
<p>//æ¿€æ´»æŒ‡å®šçš„çº¹ç†å•å…ƒ<br>gl.activeTexture(gl.TEXTURE0);<br>gl.y=this._createTexture(); // åˆ›å»ºçº¹ç†<br>gl.uniform1i(gl.getUniformLocation(program,â€™samplerYâ€™),0);//è·å–samplerYå˜é‡çš„å­˜å‚¨ä½ç½®ï¼ŒæŒ‡å®šçº¹ç†å•å…ƒç¼–å·0å°†çº¹ç†å¯¹è±¡ä¼ é€’ç»™samplerY<br>gl.activeTexture(gl.TEXTURE1);<br>gl.u=this._createTexture();<br>gl.uniform1i(gl.getUniformLocation(program,â€™samplerUâ€™),1);//è·å–samplerUå˜é‡çš„å­˜å‚¨ä½ç½®ï¼ŒæŒ‡å®šçº¹ç†å•å…ƒç¼–å·1å°†çº¹ç†å¯¹è±¡ä¼ é€’ç»™samplerU<br>gl.activeTexture(gl.TEXTURE2);<br>gl.v=this._createTexture();<br>gl.uniform1i(gl.getUniformLocation(program,â€™samplerVâ€™),2);//è·å–samplerVå˜é‡çš„å­˜å‚¨ä½ç½®ï¼ŒæŒ‡å®šçº¹ç†å•å…ƒç¼–å·2å°†çº¹ç†å¯¹è±¡ä¼ é€’ç»™samplerV<br>æ¸²æŸ“ç»˜åˆ¶ï¼ˆPSï¼šç”±äºæˆ‘ä»¬è·å–åˆ°çš„æ•°æ®æ˜¯YUV420Pï¼Œé‚£ä¹ˆè®¡ç®—æ–¹æ³•å¯ä»¥å‚è€ƒåˆšæ‰è¯´çš„è®¡ç®—æ–¹å¼ï¼‰ã€‚</p>
<p> // è®¾ç½®æ¸…ç©ºé¢œè‰²ç¼“å†²æ—¶çš„é¢œè‰²å€¼<br> gl.clearColor(0, 0, 0, 0);<br> // æ¸…ç©ºç¼“å†²<br> gl.clear(gl.COLOR_BUFFER_BIT);<br>let uOffset = width * height;<br>let vOffset = (width &gt;&gt; 1) * (height &gt;&gt; 1);<br>gl.bindTexture(gl.TEXTURE_2D, gl.y);<br>// å¡«å……Yçº¹ç†,Y çš„å®½åº¦å’Œé«˜åº¦å°±æ˜¯ widthï¼Œå’Œ heightï¼Œå­˜å‚¨çš„ä½ç½®å°±æ˜¯data.subarray(0, width * height)<br>gl.texImage2D(<br>    gl.TEXTURE_2D,<br>    0,<br>    gl.LUMINANCE,<br>    width,<br>    height,<br>    0,<br>    gl.LUMINANCE,<br>    gl.UNSIGNED_BYTE,<br>    data.subarray(0, uOffset)<br>);<br>gl.bindTexture(gl.TEXTURE_2D, gl.u);<br>// å¡«å……Uçº¹ç†,Y çš„å®½åº¦å’Œé«˜åº¦å°±æ˜¯ width/2 å’Œ height/2ï¼Œå­˜å‚¨çš„ä½ç½®å°±æ˜¯data.subarray(width * height, width/2 * height/2 + width * height)<br>gl.texImage2D(<br>    gl.TEXTURE_2D,<br>    0,<br>    gl.LUMINANCE,<br>    width &gt;&gt; 1,<br>    height &gt;&gt; 1,<br>    0,<br>    gl.LUMINANCE,<br>    gl.UNSIGNED_BYTE,<br>    data.subarray(uOffset, uOffset + vOffset)<br>);<br>gl.bindTexture(gl.TEXTURE_2D, gl.v);<br>// å¡«å……Uçº¹ç†,Y çš„å®½åº¦å’Œé«˜åº¦å°±æ˜¯ width/2 å’Œ height/2ï¼Œå­˜å‚¨çš„ä½ç½®å°±æ˜¯data.subarray(width/2 * height/2 + width * height, data.length)<br>gl.texImage2D(<br>    gl.TEXTURE_2D,<br>    0,<br>    gl.LUMINANCE,<br>    width &gt;&gt; 1,<br>    height &gt;&gt; 1,<br>    0,<br>    gl.LUMINANCE,<br>    gl.UNSIGNED_BYTE,<br>    data.subarray(uOffset + vOffset, data.length)<br>);<br>gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4); // ç»˜åˆ¶å››ä¸ªç‚¹ï¼Œä¹Ÿå°±æ˜¯é•¿æ–¹å½¢<br>ä¸Šè¿°é‚£äº›æ­¥éª¤æœ€ç»ˆå¯ä»¥ç»˜åˆ¶æˆè¿™å¼ å›¾ï¼š</p>
<p>å®Œæ•´ä»£ç ï¼š</p>
<p>export default class WebglScreen {<br>    constructor(canvas) {<br>        this.canvas = canvas;<br>        this.gl = canvas.getContext(â€˜webglâ€™) || canvas.getContext(â€˜experimental-webglâ€™);<br>        this._init();<br>    }<br>    _init() {<br>        let gl = this.gl;<br>        if (!gl) {<br>            console.log(â€˜gl not supportï¼â€™);<br>            return;<br>        }<br>        // å›¾åƒé¢„å¤„ç†<br>        gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);<br>        // GLSL æ ¼å¼çš„é¡¶ç‚¹ç€è‰²å™¨ä»£ç <br>        let vertexShaderSource = <code>attribute lowp vec4 a_vertexPosition;
            attribute vec2 a_texturePosition;
            varying vec2 v_texCoord;
            void main() {
                gl_Position = a_vertexPosition;
                v_texCoord = a_texturePosition;
            }</code>;<br>        let fragmentShaderSource = <code>precision lowp float;
            uniform sampler2D samplerY;
            uniform sampler2D samplerU;
            uniform sampler2D samplerV;
            varying vec2 v_texCoord;
            void main() {
                float r,g,b,y,u,v,fYmul;
                y = texture2D(samplerY, v_texCoord).r;
                u = texture2D(samplerU, v_texCoord).r;
                v = texture2D(samplerV, v_texCoord).r;
                fYmul = y * 1.1643828125;
                r = fYmul + 1.59602734375 * v - 0.870787598;
                g = fYmul - 0.39176171875 * u - 0.81296875 * v + 0.52959375;
                b = fYmul + 2.01723046875 * u - 1.081389160375;
                gl_FragColor = vec4(r, g, b, 1.0);
            }</code>;<br>        let vertexShader = this._compileShader(vertexShaderSource, gl.VERTEX_SHADER);<br>        let fragmentShader = this._compileShader(fragmentShaderSource, gl.FRAGMENT_SHADER);<br>        let program = this._createProgram(vertexShader, fragmentShader);<br>        this._initVertexBuffers(program);<br>        // æ¿€æ´»æŒ‡å®šçš„çº¹ç†å•å…ƒ<br>        gl.activeTexture(gl.TEXTURE0);<br>        gl.y = this._createTexture();<br>        gl.uniform1i(gl.getUniformLocation(program, â€˜samplerYâ€™), 0);<br>        gl.activeTexture(gl.TEXTURE1);<br>        gl.u = this._createTexture();<br>        gl.uniform1i(gl.getUniformLocation(program, â€˜samplerUâ€™), 1);<br>        gl.activeTexture(gl.TEXTURE2);<br>        gl.v = this._createTexture();<br>        gl.uniform1i(gl.getUniformLocation(program, â€˜samplerVâ€™), 2);<br>    }<br>    /**<br>     * åˆå§‹åŒ–é¡¶ç‚¹ buffer<br>     * @param {glProgram} program ç¨‹åº<br>     <em>/<br>    _initVertexBuffers(program) {<br>        let gl = this.gl;<br>        let vertexBuffer = gl.createBuffer();<br>        let vertexRectangle = new Float32Array([<br>            1.0,<br>            1.0,<br>            0.0,<br>            -1.0,<br>            1.0,<br>            0.0,<br>            1.0,<br>            -1.0,<br>            0.0,<br>            -1.0,<br>            -1.0,<br>            0.0<br>        ]);<br>        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);<br>        // å‘ç¼“å†²åŒºå†™å…¥æ•°æ®<br>        gl.bufferData(gl.ARRAY_BUFFER, vertexRectangle, gl.STATIC_DRAW);<br>        // æ‰¾åˆ°é¡¶ç‚¹çš„ä½ç½®<br>        let vertexPositionAttribute = gl.getAttribLocation(program, â€˜a_vertexPositionâ€™);<br>        // å‘Šè¯‰æ˜¾å¡ä»å½“å‰ç»‘å®šçš„ç¼“å†²åŒºä¸­è¯»å–é¡¶ç‚¹æ•°æ®<br>        gl.vertexAttribPointer(vertexPositionAttribute, 3, gl.FLOAT, false, 0, 0);<br>        // è¿æ¥vertexPosition å˜é‡ä¸åˆ†é…ç»™å®ƒçš„ç¼“å†²åŒºå¯¹è±¡<br>        gl.enableVertexAttribArray(vertexPositionAttribute);<br>        let textureRectangle = new Float32Array([1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0]);<br>        let textureBuffer = gl.createBuffer();<br>        gl.bindBuffer(gl.ARRAY_BUFFER, textureBuffer);<br>        gl.bufferData(gl.ARRAY_BUFFER, textureRectangle, gl.STATIC_DRAW);<br>        let textureCoord = gl.getAttribLocation(program, â€˜a_texturePositionâ€™);<br>        gl.vertexAttribPointer(textureCoord, 2, gl.FLOAT, false, 0, 0);<br>        gl.enableVertexAttribArray(textureCoord);<br>    }<br>    /*</em><br>     * åˆ›å»ºå¹¶ç¼–è¯‘ä¸€ä¸ªç€è‰²å™¨<br>     * @param {string} shaderSource GLSL æ ¼å¼çš„ç€è‰²å™¨ä»£ç <br>     * @param {number} shaderType ç€è‰²å™¨ç±»å‹, VERTEX_SHADER æˆ– FRAGMENT_SHADERã€‚<br>     * @return {glShader} ç€è‰²å™¨ã€‚<br>     <em>/<br>    _compileShader(shaderSource, shaderType) {<br>        // åˆ›å»ºç€è‰²å™¨ç¨‹åº<br>        let shader = this.gl.createShader(shaderType);<br>        // è®¾ç½®ç€è‰²å™¨çš„æºç <br>        this.gl.shaderSource(shader, shaderSource);<br>        // ç¼–è¯‘ç€è‰²å™¨<br>        this.gl.compileShader(shader);<br>        const success = this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS);<br>        if (!success) {<br>            let err = this.gl.getShaderInfoLog(shader);<br>            this.gl.deleteShader(shader);<br>            console.error(â€˜could not compile shaderâ€™, err);<br>            return;<br>        }<br>        return shader;<br>    }<br>    /*</em><br>     * ä» 2 ä¸ªç€è‰²å™¨ä¸­åˆ›å»ºä¸€ä¸ªç¨‹åº<br>     * @param {glShader} vertexShader é¡¶ç‚¹ç€è‰²å™¨ã€‚<br>     * @param {glShader} fragmentShader ç‰‡æ–­ç€è‰²å™¨ã€‚<br>     * @return {glProgram} ç¨‹åº<br>     <em>/<br>    _createProgram(vertexShader, fragmentShader) {<br>        const gl = this.gl;<br>        let program = gl.createProgram();<br>        // é™„ä¸Šç€è‰²å™¨<br>        gl.attachShader(program, vertexShader);<br>        gl.attachShader(program, fragmentShader);<br>        gl.linkProgram(program);<br>        // å°† WebGLProgram å¯¹è±¡æ·»åŠ åˆ°å½“å‰çš„æ¸²æŸ“çŠ¶æ€ä¸­<br>        gl.useProgram(program);<br>        const success = this.gl.getProgramParameter(program, this.gl.LINK_STATUS);<br>        if (!success) {<br>            console.err(â€˜program fail to linkâ€™ + this.gl.getShaderInfoLog(program));<br>            return;<br>        }<br>        return program;<br>    }<br>    /*</em><br>     * è®¾ç½®çº¹ç†<br>     <em>/<br>    _createTexture(filter = this.gl.LINEAR) {<br>        let gl = this.gl;<br>        let t = gl.createTexture();<br>        // å°†ç»™å®šçš„ glTexture ç»‘å®šåˆ°ç›®æ ‡ï¼ˆç»‘å®šç‚¹<br>        gl.bindTexture(gl.TEXTURE_2D, t);<br>        // çº¹ç†åŒ…è£… å‚è€ƒ<a href="https://github.com/fem-d/webGL/blob/master/blog/WebGLåŸºç¡€å­¦ä¹ ç¯‡ï¼ˆLesson%207ï¼‰.md" target="_blank" rel="noopener">https://github.com/fem-d/webGL/blob/master/blog/WebGLåŸºç¡€å­¦ä¹ ç¯‡ï¼ˆLesson%207ï¼‰.md</a> -&gt; Texture wrapping<br>        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);<br>        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);<br>        // è®¾ç½®çº¹ç†è¿‡æ»¤æ–¹å¼<br>        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filter);<br>        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);<br>        return t;<br>    }<br>    /*</em><br>     * æ¸²æŸ“å›¾ç‰‡å‡ºæ¥<br>     * @param {number} width å®½åº¦<br>     * @param {number} height é«˜åº¦<br>     <em>/<br>    renderImg(width, height, data) {<br>        let gl = this.gl;<br>        // è®¾ç½®è§†å£ï¼Œå³æŒ‡å®šä»æ ‡å‡†è®¾å¤‡åˆ°çª—å£åæ ‡çš„xã€yä»¿å°„å˜æ¢<br>        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);<br>        // è®¾ç½®æ¸…ç©ºé¢œè‰²ç¼“å†²æ—¶çš„é¢œè‰²å€¼<br>        gl.clearColor(0, 0, 0, 0);<br>        // æ¸…ç©ºç¼“å†²<br>        gl.clear(gl.COLOR_BUFFER_BIT);<br>        let uOffset = width * height;<br>        let vOffset = (width &gt;&gt; 1) * (height &gt;&gt; 1);<br>        gl.bindTexture(gl.TEXTURE_2D, gl.y);<br>        // å¡«å……çº¹ç†<br>        gl.texImage2D(<br>            gl.TEXTURE_2D,<br>            0,<br>            gl.LUMINANCE,<br>            width,<br>            height,<br>            0,<br>            gl.LUMINANCE,<br>            gl.UNSIGNED_BYTE,<br>            data.subarray(0, uOffset)<br>        );<br>        gl.bindTexture(gl.TEXTURE_2D, gl.u);<br>        gl.texImage2D(<br>            gl.TEXTURE_2D,<br>            0,<br>            gl.LUMINANCE,<br>            width &gt;&gt; 1,<br>            height &gt;&gt; 1,<br>            0,<br>            gl.LUMINANCE,<br>            gl.UNSIGNED_BYTE,<br>            data.subarray(uOffset, uOffset + vOffset)<br>        );<br>        gl.bindTexture(gl.TEXTURE_2D, gl.v);<br>        gl.texImage2D(<br>            gl.TEXTURE_2D,<br>            0,<br>            gl.LUMINANCE,<br>            width &gt;&gt; 1,<br>            height &gt;&gt; 1,<br>            0,<br>            gl.LUMINANCE,<br>            gl.UNSIGNED_BYTE,<br>            data.subarray(uOffset + vOffset, data.length)<br>        );<br>        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);<br>    }<br>    /*</em><br>     * æ ¹æ®é‡æ–°è®¾ç½® canvas å¤§å°<br>     * @param {number} width å®½åº¦<br>     * @param {number} height é«˜åº¦<br>     * @param {number} maxWidth æœ€å¤§å®½åº¦<br>     */<br>    setSize(width, height, maxWidth) {<br>        let canvasWidth = Math.min(maxWidth, width);<br>        this.canvas.width = canvasWidth;<br>        this.canvas.height = canvasWidth * height / width;<br>    }<br>    destroy() {<br>        const {<br>            gl<br>        } = this;<br>        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT | gl.STENCIL_BUFFER_BIT);<br>    }<br>}<br>æœ€åæˆ‘ä»¬æ¥çœ‹ä¸‹æ•ˆæœå›¾ï¼š</p>
<p>é‡åˆ°çš„é—®é¢˜<br>åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€äº›ç›´æ’­æµï¼Œæœ‰æ—¶å€™æ¸²æŸ“çš„æ—¶å€™å›¾åƒæ˜¾ç¤ºæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯é¢œè‰²ä¼šåç»¿ï¼Œç»ç ”ç©¶å‘ç°ï¼Œç›´æ’­æµçš„ä¸åŒä¸»æ’­çš„è§†é¢‘å®½åº¦æ˜¯ä¼šä¸ä¸€æ ·ï¼Œæ¯”å¦‚åœ¨ä¸»æ’­åœ¨ pk çš„æ—¶å€™å®½åº¦368ï¼Œçƒ­é—¨ä¸»æ’­å®½åº¦ä¼šåˆ° 720ï¼Œå°ä¸»æ’­å®½åº¦æ˜¯ 540ï¼Œè€Œå®½åº¦ä¸º 540 çš„ä¼šæ˜¾ç¤ºåç»¿ï¼Œå…·ä½“åŸå› æ˜¯ webgl ä¼šç»è¿‡é¢„å¤„ç†ï¼Œé»˜è®¤ä¼šå°†ä»¥ä¸‹å€¼è®¾ç½®ä¸º 4ï¼š</p>
<p>// å›¾åƒé¢„å¤„ç†<br>gl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);<br>è¿™æ ·é»˜è®¤è®¾ç½®ä¼šæ¯è¡Œ 4 ä¸ªå­—èŠ‚ 4 ä¸ªå­—èŠ‚å¤„ç†ï¼Œè€Œ Yåˆ†é‡æ¯è¡Œçš„å®½åº¦æ˜¯ 540ï¼Œæ˜¯ 4 çš„å€æ•°ï¼Œå­—èŠ‚å¯¹é½äº†ï¼Œæ‰€ä»¥å›¾åƒèƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºï¼Œè€Œ Uï¼ŒV åˆ†é‡å®½åº¦æ˜¯ 540 / 2 = 270ï¼Œ270 ä¸æ˜¯4 çš„å€æ•°ï¼Œå­—èŠ‚éå¯¹é½ï¼Œå› æ­¤è‰²ç´ å°±ä¼šæ˜¾ç¤ºåç»¿ã€‚ç›®å‰æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯ç›´æ¥è®© webgl æ¯è¡Œ 1 ä¸ªå­—èŠ‚ 1 ä¸ªå­—èŠ‚å¤„ç†ï¼ˆå¯¹æ€§èƒ½æœ‰å½±å“ï¼‰ï¼š</p>
<p>// å›¾åƒé¢„å¤„ç†<br>gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);<br>ç¬¬äºŒä¸ªæ˜¯è®©è·å–åˆ°çš„å›¾åƒçš„å®½åº¦æ˜¯ 8 çš„å€æ•°ï¼Œè¿™æ ·å°±èƒ½åšåˆ° YUV å­—èŠ‚å¯¹é½ï¼Œå°±ä¸ä¼šæ˜¾ç¤ºç»¿å±ï¼Œä½†æ˜¯ä¸å»ºè®®è¿™æ ·åšï¼Œ è½¬çš„æ—¶å€™CPUå ç”¨æå¤§ï¼Œå»ºè®®é‡‡å–ç¬¬ä¸€ä¸ªæ–¹æ¡ˆã€‚</p>
<p>å‚è€ƒæ–‡ç« <br>å›¾åƒè§†é¢‘ç¼–ç å’ŒFFmpeg(2)â€”â€”YUVæ ¼å¼ä»‹ç»å’Œåº”ç”¨ - eustoma - åšå®¢å›­<br>YUV pixel formats<br><a href="https://wiki.videolan.org/YUV/" target="_blank" rel="noopener">https://wiki.videolan.org/YUV/</a><br>ä½¿ç”¨ 8 ä½ YUV æ ¼å¼çš„è§†é¢‘å‘ˆç° | Microsoft Docs?redirectedfrom=MSDN)<br>IOS è§†é¢‘æ ¼å¼ä¹‹YUV - ç®€ä¹¦<br>å›¾è§£WebGL&amp;Three.jså·¥ä½œåŸç† - cnwander - åšå®¢å›­</p>
<p>â€”â€”â€”â€”-æœ¬æ–‡ç»“æŸæ„Ÿè°¢æ‚¨çš„é˜…è¯»â€”â€”â€”â€”-<br>æœ¬æ–‡æ ‡é¢˜:IVWEB ç©è½¬ WASM ç³»åˆ—-WEBGL YUVæ¸²æŸ“å›¾åƒå®è·µ</p>
<p>æ–‡ç« ä½œè€…:shenzekun</p>
<p>å‘å¸ƒæ—¶é—´:2019å¹´12æœˆ14æ—¥ - 13:20</p>
<p>æœ€åæ›´æ–°:2019å¹´12æœˆ14æ—¥ - 13:21</p>
<p>åŸå§‹é“¾æ¥:<a href="http://www.shenzekun.cn/IVWEB-ç©è½¬-WASM-ç³»åˆ—-WEBGL-YUVæ¸²æŸ“å›¾åƒå®è·µ.html" target="_blank" rel="noopener">http://www.shenzekun.cn/IVWEB-ç©è½¬-WASM-ç³»åˆ—-WEBGL-YUVæ¸²æŸ“å›¾åƒå®è·µ.html</a></p>
<p>è®¸å¯åè®®: ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™… è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p>
<p>æ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œï¼<br>èµ<br>webgl<br> é¡µé¢CPUå’Œå†…å­˜å ç”¨ç›‘æ§å¯è§†åŒ–Chromeæ’ä»¶-Graph Process<br>æ–‡ç« ç›®å½•ç«™ç‚¹æ¦‚è§ˆ<br>Â© 2019 shenzekun<br> åšå®¢å…¨ç«™å…± 39.8k å­—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">****** *******</span><br></pre></td></tr></table></figure>

<img src="img/heart.jpg">


    </div>

    
    
    
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:16px;">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-heart"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div>
    
</div>
      
    </div>

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/02/17/hello-world/" rel="prev" title="Hello World">
      <i class="fa fa-chevron-left"></i> Hello World
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ä½ å¥½å‘€"><span class="nav-number">1.</span> <span class="nav-text">ä½ å¥½å‘€</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="æ–°ä¹‹è¨€"
      src="/images/touxiang1.png">
  <p class="site-author-name" itemprop="name">æ–°ä¹‹è¨€</p>
  <div class="site-description" itemprop="description">æ±‚è€Œä¸å¾—ï¼Œå¾€å¾€ä¸æ±‚è€Œå¾—</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æ–°ä¹‹è¨€</span>
</div>

<!--
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.7.1
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<!--   
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
 -->
</body>
</html>
